(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"49c6":function(t,e,i){},df70:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"flex row items-start justify-center q-col-gutter-md q-pa-md"},[i("div",{staticClass:"col-12 col-sm-6 col-md-5"},[i("q-table",{attrs:{grid:"",data:t.data,selected:t.selected,"row-key":"objid",selection:"multiple",pagination:{rowsPerPage:12},loading:t.loading},on:{"update:selected":function(e){t.selected=e}},scopedSlots:t._u([{key:"top",fn:function(){return[i("q-checkbox",{staticClass:"col-auto",attrs:{value:0!=t.selected.length&&(!(t.selected.length<t.data.length)||null)},on:{input:function(e){return t.selectAll()}}}),i("div",{staticClass:"col-2 q-table__title"},[t._v("存储")]),i("q-space"),i("q-input",{staticClass:"q-ma-xs",attrs:{label:"图片ID",dense:""},scopedSlots:t._u([{key:"append",fn:function(){return[i("q-btn",{style:0==t.changeSite?"color: #575757":1==t.changeSite?"color: #1da1f2":"color: #0096fa",attrs:{unelevated:"",flat:"",round:"",dark:"",size:"sm"},on:{click:function(e){return t.change_site()}}},[t._v(t._s(0==t.changeSite?"N":1==t.changeSite?"T":"P"))])]},proxy:!0}]),model:{value:t.imgAdd_input,callback:function(e){t.imgAdd_input=e},expression:"imgAdd_input"}}),i("q-btn",{staticClass:"q-ma-xs",attrs:{disabled:!t.imgAdd_inputIsVaild,unelevated:"",round:"",color:"positive",icon:"add"},on:{click:function(e){return t.itemAppend()}}}),i("q-btn",{staticClass:"q-ma-xs",attrs:{unelevated:"",round:"",color:"primary",icon:"send"}},[i("q-menu",[i("div",{staticClass:"q-pa-md q-gutter-y-sm"},[i("div",[i("q-checkbox",{attrs:{label:"定时投递"},model:{value:t.timing,callback:function(e){t.timing=e},expression:"timing"}})],1),t.timing?i("div",[i("q-btn",{attrs:{label:null==t.datetime?"设定时间":t.datetime,color:"primary"},on:{click:function(e){t.datetime_next=!1,t.datetime_dialog=!0}}},[i("q-dialog",{attrs:{"transition-show":"scale","transition-hide":"scale"},model:{value:t.datetime_dialog,callback:function(e){t.datetime_dialog=e},expression:"datetime_dialog"}},[t.datetime_next?i("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm:00",format24h:""},model:{value:t.datetime,callback:function(e){t.datetime=e},expression:"datetime"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm"},[i("q-btn",{attrs:{label:"OK",color:"primary",flat:""},on:{click:function(e){t.datetime_dialog=!t.datetime_dialog}}})],1)]):i("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm:00",locale:t.zh_cn},model:{value:t.datetime,callback:function(e){t.datetime=e},expression:"datetime"}},[i("div",{staticClass:"row items-center justify-end q-gutter-sm"},[i("q-btn",{attrs:{label:"NEXT",color:"primary",flat:""},on:{click:function(e){t.datetime_next=!0}}})],1)])],1)],1)],1):t._e(),i("div",[i("q-checkbox",{attrs:{label:"强制审核"},model:{value:t.forceReview,callback:function(e){t.forceReview=e},expression:"forceReview"}})],1),i("div",[i("q-checkbox",{attrs:{label:"被删自动重发"},model:{value:t.reSend,callback:function(e){t.reSend=e},expression:"reSend"}})],1),i("div",[i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticStyle:{width:"100%"},attrs:{disabled:!t.isSendable,label:"投递",push:"",color:"white","text-color":"primary"},on:{click:function(e){return t.sendDynamic(t.selected)}}})],1)])])],1),i("q-btn",{staticClass:"q-ma-xs",attrs:{disabled:!t.isSendable,unelevated:"",round:"",color:"red",icon:"delete"},on:{click:function(e){return t.deleteItem(t.selected)}}})]},proxy:!0},{key:"item",fn:function(e){return[i("div",{staticClass:"col-xs-6 col-sm-6 col-md-4 q-pa-sm"},[i("q-card",{attrs:{flat:"",bordered:""}},[i("div",{staticClass:"row"},[i("q-checkbox",{staticClass:"col",model:{value:e.selected,callback:function(i){t.$set(e,"selected",i)},expression:"props.selected"}}),i("q-btn",{attrs:{flat:"",round:"",icon:"menu"}},[i("q-menu",[i("q-list",[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(i){return t.sendDynamic(e.row)}}},[i("q-item-section",[t._v("投递")])],1),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(i){return t.deleteItem(e.row)}}},[i("q-item-section",[t._v("删除")])],1),i("q-separator"),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(i){"seiga"==e.row.site?t.copyToClipboard("im"+e.row.id):t.copyToClipboard(e.row.id)}}},[i("q-item-section",[t._v("复制ID")])],1)],1)],1)],1)],1),i("q-separator"),i("a",{attrs:{href:"seiga"==e.row.site?"https://seiga.nicovideo.jp/seiga/im"+e.row.id:"twitter"==e.row.site?"https://twitter.com/"+e.row.userScreenName+"/status/"+e.row.id:"pixiv"==e.row.site?"https://www.pixiv.net/artworks/"+e.row.id:"",target:"_blank"}},[i("q-img",{staticClass:"img",attrs:{src:"seiga"==e.row.site?"https://lohas.nicoseiga.jp/thumb/"+e.row.id+"i":"twitter"==e.row.site?e.row.media[0].media_url:"pixiv"==e.row.site?"https://pixiv.cat/"+e.row.id+".jpg":"",ratio:"1"}},[i("div",{staticClass:"absolute-bottom text-center img-caption",staticStyle:{padding:"0"}},[t._v("\n                  "+t._s(e.row.site)+"\n                  "),i("br"),t._v("\n                  "+t._s(e.row.id)+"\n                ")])])],1)],1)],1)]}},{key:"loading",fn:function(){return[i("q-inner-loading",{attrs:{showing:""}},[i("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1)]},proxy:!0}])})],1),i("div",{staticClass:"col-12 col-sm-6 col-md-5"},[i("q-table",{attrs:{grid:"",data:t.dynamics_data,selected:t.selected_dynamic,"row-key":function(t){return t.desc.dynamic_id},selection:"multiple",pagination:{rowsPerPage:12},loading:t.loading_dynamic},on:{"update:selected":function(e){t.selected_dynamic=e}},scopedSlots:t._u([{key:"top",fn:function(){return[i("div",{staticClass:"col-2 q-table__title"},[t._v("动态")]),i("q-space"),i("q-btn",{staticClass:"q-ma-xs",attrs:{unelevated:"",round:"",color:"grey",icon:"refresh"},on:{click:function(e){return t.dynamicReset()}}}),i("q-btn",{staticClass:"q-ma-xs",attrs:{unelevated:"",round:"",color:"red",icon:"delete"},on:{click:function(e){return t.deleteDynamic(t.selected_dynamic)}}})]},proxy:!0},{key:"item",fn:function(e){return[i("div",{staticClass:"col-xs-6 col-sm-6 col-md-4 q-pa-sm"},[i("q-card",{style:0!=t.isReviewing(e.row.extend_json)?"background-color: #fff1d3;":"background-color: white;",attrs:{flat:"",bordered:""}},[i("div",{staticClass:"row"},[i("q-checkbox",{staticClass:"col",model:{value:e.selected,callback:function(i){t.$set(e,"selected",i)},expression:"props.selected"}}),i("q-btn",{attrs:{flat:"",round:"",icon:"menu"}},[i("q-menu",[i("q-list",[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-red",attrs:{clickable:""},on:{click:function(i){return t.deleteDynamic(e.row)}}},[i("q-item-section",[t._v("删除")])],1)],1)],1)],1)],1),i("q-separator"),i("a",{attrs:{href:"https://h.bilibili.com/"+e.row.desc.rid,target:"_blank"}},[i("q-img",{attrs:{src:e.row.card.item.pictures[0].img_src.replace(/https:\/\/i0.hdslb.com/g,"/bilialbum")+"@240w_240h_1e_1c.webp",ratio:"1"}},[i("div",{staticClass:"absolute-bottom text-center",staticStyle:{padding:"6px"}},[i("span",[i("q-icon",{staticClass:"q-mr-xs",attrs:{name:"reply",size:"xs"}}),t._v(t._s(e.row.desc.repost)+"\n                  ")],1),i("span",{staticClass:"q-mx-xs"},[i("q-icon",{staticClass:"q-mr-xs",attrs:{name:"comment",size:"xs"}}),t._v(t._s(e.row.desc.comment)+"\n                  ")],1),i("span",[i("q-icon",{staticClass:"q-mr-xs",attrs:{name:"thumb_up",size:"xs"}}),t._v(t._s(e.row.desc.like)+"\n                  ")],1)])])],1)],1)],1)]}},{key:"loading",fn:function(){return[i("q-inner-loading",{attrs:{showing:""}},[i("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1)]},proxy:!0}])})],1)])},n=[],o=(a("e6cf"),a("5319"),a("ddb0"),{name:"GetThumbnail",data(){return{data:[],dynamics_data:[],selected:[],selected_dynamic:[],loading:!1,loading_dynamic:!1,changeSite:0,imgAdd_input:"",timing:!1,forceReview:!1,reSend:!1,datetime:null,datetime_dialog:!1,datetime_next:!1,zh_cn:{days:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),daysShort:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_")}}},methods:{async reset(){this.data=[],this.selected=[],this.loading=!0;let t=new this.$AV.Query("seigaList"),e=new this.$AV.Query("tweetList"),i=new this.$AV.Query("pixivList"),a=Array.prototype.concat(await t.find(),await e.find(),await i.find());if(0!=a.length)for(let s in a)this.data.push(a[s].attributes),this.data[s].objid=a[s].id;this.loading=!1},dbAppend(t){if("seiga"==t.site){let e=this.$AV.Object.extend("seigaList"),i=new e,a=new this.$AV.ACL;a.setPublicReadAccess(!0),a.setPublicWriteAccess(!0),i.setACL(a),i.set("created",t.created),i.set("description",t.desc),i.set("id",t.id),i.set("img_url",t.img_url),i.set("poster",t.poster),i.set("tags",t.tags),i.set("title",t.title),i.set("uid",Number(t.uid)),i.set("tags_locked",t.tags_locked),i.save()}else if("twitter"==t.site){let e=this.$AV.Object.extend("tweetList"),i=new e,a=new this.$AV.ACL;a.setPublicReadAccess(!0),a.setPublicWriteAccess(!0),i.setACL(a),i.set("id",t.id),i.set("text",t.text),i.set("userName",t.userName),i.set("userScreenName",t.userScreenName),i.set("userId",t.userId),i.set("media",t.media),"object"==typeof t.created_at?i.set("created_at",t.created_at):i.set("created_at",new Date(t.created_at)),i.save()}else if("pixiv"==t.site){let e=this.$AV.Object.extend("pixivList"),a=new e,s=new this.$AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),a.setACL(s),a.set("id",String(t.id)),a.set("title",t.title);let n=[];for(i in t.tags)n.push(t.tags[i].name);a.set("tags",n),a.set("poster",t.user.name),a.set("uid",String(t.user.id)),a.set("description",t.caption);let o=[];o=0===t.meta_pages.length?[{image_urls:{original:t.meta_single_page.original_image_url}}]:t.meta_pages,o=JSON.parse(JSON.stringify(o).replace(/i.pximg.net/g,"i.pixiv.cat")),a.set("img_urls",o),a.set("created",new Date(t.create_date)),a.set("type",t.type),a.save()}},async itemAppend(){if(this.loading=!0,0==this.changeSite){let e;-1!=this.imgAdd_input.indexOf("im")&&(this.imgAdd_input=this.imgAdd_input.replace(/^im/g,""));try{e=await this.$util.post("/ajax/getSeigaData",this.imgAdd_input),e.data.site="seiga";try{this.dbAppend(e.data),setTimeout(this.reset,1250)}catch(t){this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.loading=!1}}catch(t){this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.loading=!1}}else if(1==this.changeSite){let e;try{e=await this.$util.post("/ajax/getTweetData",this.imgAdd_input),e.data.data.site="twitter";try{this.dbAppend(e.data.data),setTimeout(this.reset,1250)}catch(t){this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.loading=!1}}catch(t){this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.loading=!1}}else if(1==this.changeSite){let e;try{e=await this.$util.post("/ajax/getIllustData",this.imgAdd_input),e.data.site="pixiv";try{this.dbAppend(e.data),setTimeout(this.reset,1250)}catch(t){this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.loading=!1}}catch(t){this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.loading=!1}}},deleteItem(t=[]){this.loading=!0,Array.isArray(t)||(t=[t]);for(let e of t){let t;"seiga"==e.site?t=this.$AV.Object.createWithoutData("seigaList",e.objid):"twitter"==e.site?t=this.$AV.Object.createWithoutData("tweetList",e.objid):"pixiv"==e.site&&(t=this.$AV.Object.createWithoutData("pixivList",e.objid)),t.destroy()}setTimeout(this.reset,1250)},change_site(){this.changeSite++,this.changeSite>2&&(this.changeSite=0)},selectAll(){this.selected.length<this.data.length?this.selected=this.data:this.selected=[]},async sendDynamic(t){this.loading=!0,Array.isArray(t)||(t=[t]);let e={data:[],data_twi:[],data_pixiv:[]};for(let i of t)"seiga"==i.site?e.data.push(i):"twitter"==i.site?e.data_twi.push(i):"pixiv"==i.site&&e.data_pixiv.push(i);1==this.timing?(e.timing=!0,e.date=this.datetime):(e.timing=!1,e.date=null),e.shz=this.forceReview,e.resend=this.reSend;await this.$util.post("/cookieartbot/api/dynamic/upload",e);for(let i of t){let t;"seiga"==i.site?t=this.$AV.Object.createWithoutData("seigaList",i.objid):"twitter"==i.site?t=this.$AV.Object.createWithoutData("tweetList",i.objid):"pixiv"==i.site&&(t=this.$AV.Object.createWithoutData("pixivList",i.objid)),t.destroy()}this.$q.notify({message:"投递成功",color:"positive",position:"top"}),setTimeout(this.reset,1250)},async copyToClipboard(t,e=!1){e||await navigator.clipboard.writeText(t)},async dynamicReset(){this.loading_dynamic=!0;let t=await this.$util.get("/cookieartbot/api/getDynamic");this.dynamics_data=t.data,this.selected_dynamic=[],this.loading_dynamic=!1},async deleteDynamic(t){this.loading_dynamic=!0;let e=[];Array.isArray(t)||(t=[t]);for(let i of t)e.push(this.$util.get("/cookieartbot/api/removeDynamic",{iddym:i.desc.dynamic_id_str},"delete"));this.$axios.all(e).then((t=>{this.dynamicReset(),this.loading_dynamic=!1})).catch((t=>{this.$q.notify({message:`发生错误！\n${t}`,color:"negative",multiLine:!0,position:"top"}),this.dynamicReset(),this.loading_dynamic=!1}))},isReviewing(t){return"dispute"in t&&t.dispute.content}},created(){this.reset(),this.dynamicReset()},mounted(){},computed:{imgAdd_inputIsVaild(){return 0!=this.imgAdd_input.length},isSendable(){return 0!=this.selected.length}},watch:{}}),c=o,l=(a("f126"),a("2877")),r=a("9989"),d=a("eaac"),m=a("8f8e"),p=a("2c91"),u=a("27f9"),h=a("9c40"),g=a("4e73"),_=a("24e8"),b=a("52ee"),f=a("ca78"),y=a("f09f"),w=a("1c1c"),v=a("66e5"),q=a("4074"),x=a("eb85"),k=a("068f"),A=a("74f7"),C=a("e669"),$=a("0016"),S=a("7f67"),j=a("eebe"),D=a.n(j),L=Object(l["a"])(c,s,n,!1,null,null,null);e["default"]=L.exports;D()(L,"components",{QPage:r["a"],QTable:d["a"],QCheckbox:m["a"],QSpace:p["a"],QInput:u["a"],QBtn:h["a"],QMenu:g["a"],QDialog:_["a"],QDate:b["a"],QTime:f["a"],QCard:y["a"],QList:w["a"],QItem:v["a"],QItemSection:q["a"],QSeparator:x["a"],QImg:k["a"],QInnerLoading:A["a"],QSpinnerFacebook:C["a"],QIcon:$["a"]}),D()(L,"directives",{ClosePopup:S["a"]})},f126:function(t,e,i){"use strict";i("49c6")}}]);